---
ðŸ•µ YAML lint:
  stage: validate
  image: $IMAGE_PYTHON
  before_script:
    - !reference [.helper_header_cli.sh]
    - !reference [.helper_gitlab-ci.sh]
  script:
    - |
      curl -sk -H "PRIVATE-TOKEN: ${GITLAB_TOKEN}" $CI_SERVER_URL/$GITLAB_CI_REPOSITORY_PATH/-/raw/$GITLAB_CI_REPOSITORY_BRANCH/ci_jobs/yamllint/.yamllint.yml -o .yamllint.yml
      h1 "ðŸš€ yamllint"
      yamllint .
  rules:
    - if: $CI_COMMIT_TAG
      when: never
    - if: $CI_COMMIT_BRANCH || $CI_MERGE_REQUEST_ID
      changes:
        compare_to: 'refs/heads/main'
        paths:
          - "**/*.yml"
          - "**/*.yaml"
      when: on_success
    - when: never
